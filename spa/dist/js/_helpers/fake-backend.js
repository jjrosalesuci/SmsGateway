System.register(["@angular/http","@angular/http/testing"],function(e,s){"use strict";function t(e,s,t){var n=JSON.parse(localStorage.getItem("users"))||[];return e.connections.subscribe(function(e){setTimeout(function(){if(e.request.url.endsWith("/api/authenticate")&&e.request.method===r.RequestMethod.Post){var o=JSON.parse(e.request.getBody()),u=n.filter(function(e){return e.username===o.username&&e.password===o.password});if(u.length){var a=u[0];e.mockRespond(new r.Response(new r.ResponseOptions({status:200,body:{id:a.id,username:a.username,firstName:a.firstName,lastName:a.lastName,token:"fake-jwt-token"}})))}else e.mockError(new Error("Username or password is incorrect"))}else{if(e.request.url.endsWith("/api/users")&&e.request.method===r.RequestMethod.Get)return void("Bearer fake-jwt-token"===e.request.headers.get("Authorization")?e.mockRespond(new r.Response(new r.ResponseOptions({status:200,body:n}))):e.mockRespond(new r.Response(new r.ResponseOptions({status:401}))));if(e.request.url.match(/\/api\/users\/\d+$/)&&e.request.method===r.RequestMethod.Get)if("Bearer fake-jwt-token"===e.request.headers.get("Authorization")){var i=e.request.url.split("/"),p=parseInt(i[i.length-1]),d=n.filter(function(e){return e.id===p}),a=d.length?d[0]:null;e.mockRespond(new r.Response(new r.ResponseOptions({status:200,body:a})))}else e.mockRespond(new r.Response(new r.ResponseOptions({status:401})));else{if(e.request.url.endsWith("/api/users")&&e.request.method===r.RequestMethod.Post){var c=JSON.parse(e.request.getBody()),l=n.filter(function(e){return e.username===c.username}).length;return l?e.mockError(new Error('Username "'+c.username+'" is already taken')):(c.id=n.length+1,n.push(c),localStorage.setItem("users",JSON.stringify(n)),void e.mockRespond(new r.Response(new r.ResponseOptions({status:200}))))}if(e.request.url.match(/\/api\/users\/\d+$/)&&e.request.method===r.RequestMethod.Delete)if("Bearer fake-jwt-token"===e.request.headers.get("Authorization")){for(var i=e.request.url.split("/"),m=parseInt(i[i.length-1]),h=0;h<n.length;h++){var a=n[h];if(a.id===m){n.splice(h,1),localStorage.setItem("users",JSON.stringify(n));break}}e.mockRespond(new r.Response(new r.ResponseOptions({status:200})))}else e.mockRespond(new r.Response(new r.ResponseOptions({status:401})));else{var f=new r.Http(t,s),R=new r.RequestOptions({method:e.request.method,headers:e.request.headers,body:e.request.getBody(),url:e.request.url,withCredentials:e.request.withCredentials,responseType:e.request.responseType});f.request(e.request.url,R).subscribe(function(s){e.mockRespond(s)},function(s){e.mockError(s)})}}}},500)}),new r.Http(e,s)}var r,n,o;s&&s.id;return e("fakeBackendFactory",t),{setters:[function(e){r=e},function(e){n=e}],execute:function(){e("fakeBackendProvider",o={provide:r.Http,useFactory:t,deps:[n.MockBackend,r.BaseRequestOptions,r.XHRBackend]})}}});